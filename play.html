<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BEIRUT TAXI - PLAY</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        @font-face {
            font-family: 'FreeSerifCustom';
            src: url('images/FreeSerifBold-rdMp.otf') format('opentype');
            font-weight: bold; font-style: normal; font-display: swap;
        }
        body { background-color: #0d0d0d; color: #e0e0e0; font-family: 'FreeSerifCustom', 'Noto Sans KR', serif; margin: 0; padding-bottom: 100px; overflow-x: hidden; }
        header { margin-top: 60px; text-align: center; }
        h1.page-title { font-size: 3.5rem; color: #ffcc00; letter-spacing: 10px; margin: 0; text-transform: uppercase; }

        .main-container { display: flex; width: 95%; max-width: 1400px; margin: 50px auto; gap: 40px; }
        nav { display: flex; flex-direction: column; min-width: 120px; }
        nav a { color: #ffffff; text-decoration: none; margin-bottom: 25px; font-size: 1.1rem; letter-spacing: 2px; transition: 0.3s; opacity: 0.7; }
        nav a:hover { opacity: 1; color: #ffcc00; }

        .play-content { flex-grow: 1; width: 100%; overflow: hidden; }
        .album-grid { display: flex; gap: 20px; overflow-x: auto; padding-bottom: 30px; cursor: grab; scroll-behavior: smooth; -ms-overflow-style: none; scrollbar-width: none; }
        .album-grid::-webkit-scrollbar { display: none; }

        .album-card { width: calc((100% - 60px) / 4); min-width: calc((100% - 60px) / 4); flex-shrink: 0; cursor: pointer; box-sizing: border-box; }
        .album-card img { width: 100%; aspect-ratio: 1/1; object-fit: cover; display: block; margin-bottom: 15px; border: 1px solid #222; transition: 0.3s; }
        .album-card:hover img { border-color: #ffcc00; }
        
        .album-info { font-family: 'Noto Sans KR', sans-serif; text-align: left; }
        .album-info .title { font-size: 1.1rem; font-weight: 700; color: #fff; margin-bottom: 4px; }
        .album-info .type { font-size: 0.85rem; color: #888; }

        .track-drop-area { display: none; width: 100%; margin-top: 20px; border-top: 1px solid #222; padding-top: 20px; }
        .song-list { display: flex; gap: 20px; flex-wrap: wrap; }
        .song-btn { background: transparent; border: none; color: #aaa; cursor: pointer; transition: 0.3s; font-size: 1rem; text-decoration: underline; text-underline-offset: 5px; }
        .song-btn:hover { color: #ffcc00; }

        #display-area { display: none; width: 100%; margin-top: 60px; padding-top: 40px; border-top: 1px solid #333; }
        .video-wrapper { position: relative; padding-bottom: 56.25%; height: 0; margin-bottom: 30px; }
        .video-wrapper iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }
        .lyrics-box { line-height: 2.2; color: #ccc; white-space: pre-wrap; text-align: center; padding: 50px 20px; font-size: 1.05rem; }

        @media (max-width: 768px) {
            .main-container { flex-direction: column; }
            nav { flex-direction: row; justify-content: center; gap: 20px; }
            .album-card { width: calc((100% - 20px) / 2.3) !important; min-width: calc((100% - 20px) / 2.3) !important; }
        }
    </style>
</head>
<body>

    <header><h1 class="page-title">PLAY</h1></header>

    <div class="main-container">
        <nav>
            <a href="index.html">BRTX</a>
            <a href="members.html">MEMBERS</a>
            <a href="https://www.instagram.com/brtx_band/" target="_blank">CONTACT</a>
        </nav>

        <div class="play-content">
            <div class="album-grid" id="albumGrid">
                <div class="album-card" onclick="handleAlbumClick('album6')">
                    <img src="https://github.com/BRTXdraft/BRTXdraft.github.io/blob/main/images/artwork/06_EP_moraeal.jpg?raw=true">
                    <div class="album-info"><div class="title">모래알</div><div class="type">EP</div></div><div class="date">2025.01.26</div>
                </div>
                <div class="album-card" onclick="handleAlbumClick('album5')">
                    <img src="https://github.com/BRTXdraft/BRTXdraft.github.io/blob/main/images/artwork/05_single_eonni.jpg?raw=true">
                    <div class="album-info"><div class="title">언니</div><div class="type">Single</div></div><div class="date">2024.08.31</div>
                </div>
                <div class="album-card" onclick="handleAlbumClick('album4')">
                    <img src="https://github.com/BRTXdraft/BRTXdraft.github.io/blob/main/images/artwork/04_EP_seesaw.jpg?raw=true">
                    <div class="album-info"><div class="title">시소</div><div class="type">EP</div></div><div class="date">2023.12.27</div>
                </div>
                <div class="album-card" onclick="handleAlbumClick('album3')">
                    <img src="https://github.com/BRTXdraft/BRTXdraft.github.io/blob/main/images/artwork/03_single_unbalanced.jpeg?raw=true">
                    <div class="album-info"><div class="title">불균형</div><div class="type">Single</div></div><div class="date">2023.07.28</div>
                </div>
                <div class="album-card" onclick="handleAlbumClick('album2')">
                    <img src="https://github.com/BRTXdraft/BRTXdraft.github.io/blob/main/images/artwork/02_EP_yeonso.jpg?raw=true">
                    <div class="album-info"><div class="title">연소</div><div class="type">EP</div></div><div class="date">2022.08.23</div>
                </div>
                <div class="album-card" onclick="handleAlbumClick('album1')">
                    <img src="https://github.com/BRTXdraft/BRTXdraft.github.io/blob/main/images/artwork/01_single_surfer's%20high.jpg?raw=true">
                    <div class="album-info"><div class="title">Surfer's High</div><div class="type">Single</div></div><div class="date">2022.06.23</div>
                </div>
            </div>

            <div id="track-container" class="track-drop-area"></div>
            <div id="display-area">
                <div class="video-wrapper"><iframe id="youtube-video" src="" allow="autoplay; fullscreen"></iframe></div>
                <div class="lyrics-box" id="lyrics-text"></div>
            </div>
        </div>
    </div>

    <script src="data/lyrics.js"></script>

    <script>
        // 1. 클릭 핸들러 (EP/Single 자동 판별)
        function handleAlbumClick(albumId) {
            if (typeof trackData === 'undefined') {
                console.error("데이터 파일(data/lyrics.js)을 찾을 수 없습니다.");
                return;
            }

            const tracks = trackData[albumId];
            if (!tracks) return;

            if (tracks.length > 1) {
                // EP: 트랙 리스트 생성
                const container = document.getElementById('track-container');
                let html = '<div class="song-list">';
                tracks.forEach(t => {
                    // 가사 내 백틱(`) 기호가 충돌나지 않게 처리
                    const safeLyrics = t.lyrics.replace(/`/g, '\\`');
                    html += `<button class="song-btn" onclick="showPlayer('${t.id}', \`${safeLyrics}\`)">${t.title}</button>`;
                });
                html += '</div>';
                container.innerHTML = html;
                container.style.display = 'block';
                document.getElementById('display-area').style.display = 'none';
            } else {
                // Single: 즉시 재생
                document.getElementById('track-container').style.display = 'none';
                showPlayer(tracks[0].id, tracks[0].lyrics);
            }
        }

        // 2. 플레이어 및 가사 표시
        function showPlayer(videoId, lyrics) {
            const display = document.getElementById('display-area');
            display.style.display = 'block';
            document.getElementById('youtube-video').src = "https://www.youtube.com/embed/" + videoId + "?autoplay=1";
            document.getElementById('lyrics-text').innerText = lyrics;
            
            // 화면 이동
            window.scrollTo({ top: display.offsetTop - 20, behavior: 'smooth' });
        }

        // 3. 앨범 그리드 드래그 로직
        const slider = document.getElementById('albumGrid');
        let isDown = false, startX, scrollLeft;

        slider.onmousedown = (e) => {
            isDown = true;
            startX = e.pageX - slider.offsetLeft;
            scrollLeft = slider.scrollLeft;
        };
        slider.onmouseup = () => isDown = false;
        slider.onmouseleave = () => isDown = false;
        slider.onmousemove = (e) => {
            if(!isDown) return;
            e.preventDefault();
            const x = e.pageX - slider.offsetLeft;
            const walk = (x - startX) * 2;
            slider.scrollLeft = scrollLeft - walk;
        };
    </script>
</body>
</html>
